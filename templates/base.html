<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}HireVision - AI Career Coach{% endblock %}</title>

    {% load static %}
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="{% static 'vision.png' %}"
    />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --primary-color: #2563eb;
        --primary-dark: #1d4ed8;
        --primary-light: #3b82f6;
        --secondary-color: #64748b;
        --accent-color: #f59e0b;
        --accent-dark: #d97706;
        --success-color: #10b981;
        --danger-color: #ef4444;
        --warning-color: #f59e0b;
        --info-color: #3b82f6;
        --dark-color: #1e293b;
        --light-color: #f8fafc;
        --border-color: #e2e8f0;
        --border-light: #f1f5f9;
        --text-muted: #64748b;
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1),
          0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1),
          0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1),
          0 8px 10px -6px rgb(0 0 0 / 0.1);
        --radius-sm: 6px;
        --radius-md: 8px;
        --radius-lg: 12px;
        --radius-xl: 16px;
      }

      * {
        font-family: "Inter", sans-serif;
      }

      body {
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        color: var(--dark-color);
        line-height: 1.6;
        min-height: 100vh;
      }

      /* Enhanced Navigation */
      .navbar {
        background: rgba(30, 41, 59, 0.98) !important;
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding: 0.75rem 0;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 1030;
      }

      .navbar-brand {
        font-weight: 800;
        font-size: 1.75rem;
        color: white !important;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.3s ease;
        padding: 0.5rem 0;
      }

      .navbar-brand i {
        font-size: 1.5rem;
        background: linear-gradient(
          135deg,
          var(--primary-light) 0%,
          var(--accent-color) 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .navbar-brand:hover {
        color: var(--accent-color) !important;
        transform: scale(1.05);
      }

      .navbar-nav {
        gap: 0.25rem;
      }

      .nav-link {
        font-weight: 500;
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.85) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        padding: 0.6rem 1rem !important;
        border-radius: var(--radius-md);
        margin: 0 0.1rem;
        display: flex;
        align-items: center;
        gap: 0.4rem;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
      }

      .nav-link::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.1),
          transparent
        );
        transition: left 0.5s;
      }

      .nav-link:hover::before {
        left: 100%;
      }

      .nav-link:hover {
        color: white !important;
        background: rgba(255, 255, 255, 0.15);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .nav-link.active {
        color: var(--accent-color) !important;
        background: rgba(245, 158, 11, 0.15);
        box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
      }

      .nav-link i {
        font-size: 0.85rem;
        width: 16px;
        text-align: center;
      }

      /* Enhanced Navbar Toggler */
      .navbar-toggler {
        border: none;
        padding: 0.5rem;
        border-radius: var(--radius-md);
        transition: all 0.3s ease;
      }

      .navbar-toggler:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .navbar-toggler:focus {
        box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.25);
      }

      /* Enhanced Dropdown */
      .dropdown-menu {
        border: none;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-xl);
        padding: 0.75rem;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(0, 0, 0, 0.05);
        margin-top: 0.5rem;
      }

      .dropdown-item {
        border-radius: var(--radius-md);
        padding: 0.75rem 1rem;
        font-weight: 500;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .dropdown-item:hover {
        background: linear-gradient(
          135deg,
          var(--light-color) 0%,
          #e2e8f0 100%
        );
        color: var(--dark-color);
        transform: translateX(4px);
      }

      .dropdown-divider {
        margin: 0.5rem 0;
        border-color: var(--border-color);
      }

      /* Enhanced Buttons */
      .btn {
        font-weight: 600;
        border-radius: var(--radius-md);
        padding: 0.75rem 1.5rem;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: none;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        position: relative;
        overflow: hidden;
      }

      .btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .btn:hover::before {
        left: 100%;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--primary-dark) 100%
        );
        color: white;
        box-shadow: var(--shadow-md);
      }

      .btn-primary:hover {
        background: linear-gradient(
          135deg,
          var(--primary-dark) 0%,
          #1e40af 100%
        );
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
        color: white;
      }

      .btn-outline-light {
        border: 2px solid rgba(255, 255, 255, 0.8);
        color: rgba(255, 255, 255, 0.9);
        background: transparent;
        backdrop-filter: blur(10px);
      }

      .btn-outline-light:hover {
        background: rgba(255, 255, 255, 0.15);
        border-color: white;
        color: white;
        transform: translateY(-1px);
      }

      .btn-light {
        background: linear-gradient(135deg, white 0%, #f8fafc 100%);
        color: var(--dark-color);
        box-shadow: var(--shadow-md);
      }

      .btn-light:hover {
        background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
        color: var(--dark-color);
      }

      /* Enhanced Cards */
      .card {
        border: none;
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-sm);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        background: linear-gradient(135deg, white 0%, #fefefe 100%);
        overflow: hidden;
        position: relative;
      }

      .card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--accent-color),
          var(--primary-light)
        );
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-xl);
      }

      .card:hover::before {
        opacity: 1;
      }

      .card-body {
        padding: 2rem;
        position: relative;
      }

      /* Enhanced Forms */
      .form-control {
        border-radius: var(--radius-md);
        border: 2px solid var(--border-color);
        padding: 0.875rem 1rem;
        font-size: 1rem;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        background: white;
        font-weight: 500;
      }

      .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
        outline: none;
        transform: translateY(-1px);
      }

      .form-label {
        font-weight: 600;
        color: var(--dark-color);
        margin-bottom: 0.5rem;
        font-size: 0.95rem;
      }

      /* Enhanced Alerts */
      .alert {
        border: none;
        border-radius: var(--radius-lg);
        padding: 1.25rem 1.5rem;
        font-weight: 500;
        border-left: 4px solid;
        position: relative;
        overflow: hidden;
      }

      .alert::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        opacity: 0.05;
        background: radial-gradient(
          circle at top right,
          currentColor,
          transparent
        );
      }

      .alert-success {
        background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
        color: #065f46;
        border-left-color: var(--success-color);
      }

      .alert-danger {
        background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
        color: #991b1b;
        border-left-color: var(--danger-color);
      }

      .alert-warning {
        background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        color: #92400e;
        border-left-color: var(--warning-color);
      }

      .alert-info {
        background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
        color: #1e40af;
        border-left-color: var(--info-color);
      }

      /* Enhanced Toast Notifications */
      .toast {
        border: none;
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-xl);
        backdrop-filter: blur(20px);
        background: rgba(255, 255, 255, 0.98);
        border: 1px solid rgba(0, 0, 0, 0.05);
        overflow: hidden;
      }

      .toast-header {
        border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        padding: 1rem 1.25rem;
        font-weight: 600;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      }

      .toast-header.alert-success {
        background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
        color: #065f46;
      }

      .toast-header.alert-danger {
        background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
        color: #991b1b;
      }

      .toast-header.alert-warning {
        background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        color: #92400e;
      }

      .toast-header.alert-info {
        background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
        color: #1e40af;
      }

      .toast-body {
        padding: 1.25rem;
        font-weight: 500;
        color: var(--dark-color);
      }

      /* Enhanced Modal */
      .modal-content {
        border: none;
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-xl);
        overflow: hidden;
      }

      .modal-header {
        padding: 1.5rem 1.75rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }

      .modal-body {
        padding: 2rem 1.75rem;
      }

      /* Thread and Comment Enhanced Styling */
      .thread-content {
        line-height: 1.7;
        color: var(--dark-color);
        font-weight: 400;
      }

      .comment-content {
        line-height: 1.6;
        color: var(--dark-color);
        font-weight: 400;
      }

      .thread-card {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid var(--border-color);
        position: relative;
        overflow: hidden;
      }

      .thread-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--accent-color)
        );
        transform: scaleX(0);
        transition: transform 0.3s ease;
      }

      .thread-card:hover {
        border-color: var(--primary-color);
        box-shadow: 0 8px 25px rgba(37, 99, 235, 0.15);
        transform: translateY(-4px);
      }

      .thread-card:hover::before {
        transform: scaleX(1);
      }

      .comment-item {
        border-left: 3px solid var(--border-light);
        padding-left: 1.5rem;
        margin-bottom: 2rem;
        transition: all 0.3s ease;
        position: relative;
      }

      .comment-item::before {
        content: "";
        position: absolute;
        left: -3px;
        top: 0;
        bottom: 0;
        width: 3px;
        background: linear-gradient(
          180deg,
          var(--primary-color),
          var(--accent-color)
        );
        transform: scaleY(0);
        transition: transform 0.3s ease;
      }

      .comment-item:hover {
        padding-left: 2rem;
      }

      .comment-item:hover::before {
        transform: scaleY(1);
      }

      /* Enhanced User Avatar */
      .user-avatar {
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        color: white;
        border-radius: 50%;
        position: relative;
        overflow: hidden;
      }

      .user-avatar::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(
          45deg,
          transparent,
          rgba(255, 255, 255, 0.1),
          transparent
        );
        transform: rotate(45deg);
        transition: transform 0.6s ease;
      }

      .user-avatar:hover::before {
        transform: rotate(45deg) translate(50%, 50%);
      }

      .user-avatar.primary {
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--primary-dark) 100%
        );
      }

      .user-avatar.secondary {
        background: linear-gradient(
          135deg,
          var(--secondary-color) 0%,
          #6b7280 100%
        );
      }

      /* Enhanced Utility Classes */
      .text-gradient {
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--accent-color) 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 700;
      }

      .bg-gradient-primary {
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--primary-dark) 100%
        );
      }

      .bg-gradient-accent {
        background: linear-gradient(
          135deg,
          var(--accent-color) 0%,
          var(--accent-dark) 100%
        );
      }

      /* Enhanced Loading States */
      .btn.loading {
        pointer-events: none;
        opacity: 0.7;
      }

      .btn.loading i {
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      /* Enhanced Image Preview */
      .image-preview {
        border-radius: var(--radius-lg);
        overflow: hidden;
        background: var(--light-color);
        border: 2px dashed var(--border-color);
        transition: all 0.3s ease;
      }

      .image-preview:hover {
        border-color: var(--primary-color);
        transform: scale(1.02);
      }

      /* Professional Footer */
      footer {
        background: linear-gradient(135deg, var(--dark-color) 0%, #0f172a 100%);
        color: rgba(255, 255, 255, 0.8);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        margin-top: auto;
      }

      /* Enhanced Scrollbar */
      ::-webkit-scrollbar {
        width: 10px;
      }

      ::-webkit-scrollbar-track {
        background: var(--light-color);
        border-radius: 5px;
      }

      ::-webkit-scrollbar-thumb {
        background: linear-gradient(
          135deg,
          var(--secondary-color) 0%,
          var(--dark-color) 100%
        );
        border-radius: 5px;
        transition: all 0.3s ease;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(135deg, var(--dark-color) 0%, #0f172a 100%);
      }

      /* Enhanced Responsive Design */
      @media (max-width: 992px) {
        .navbar-nav {
          gap: 0;
          margin-top: 1rem;
          padding-top: 1rem;
          border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-link {
          justify-content: flex-start;
          margin: 0.25rem 0;
          padding: 0.75rem 1rem !important;
        }
      }

      @media (max-width: 768px) {
        .navbar-brand {
          font-size: 1.5rem;
        }

        .btn {
          padding: 0.625rem 1.25rem;
          font-size: 0.9rem;
        }

        .card-body {
          padding: 1.5rem;
        }

        .nav-link {
          font-size: 0.95rem;
          padding: 0.7rem 1rem !important;
        }
      }

      @media (max-width: 576px) {
        .navbar-brand {
          font-size: 1.25rem;
        }

        .btn-group-sm .btn {
          padding: 0.375rem 0.75rem;
          font-size: 0.8rem;
        }

        .card-body {
          padding: 1.25rem;
        }

        .thread-content,
        .comment-content {
          font-size: 0.9rem;
        }

        .toast-container {
          left: 1rem;
          right: 1rem;
          top: auto !important;
          bottom: 1rem;
        }

        .modal-body {
          padding: 1.5rem 1.25rem;
        }
      }

      /* Enhanced Animation for Page Load */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .fade-in-up {
        animation: fadeInUp 0.6s ease-out;
      }

      /* Enhanced Focus States for Accessibility */
      .btn:focus,
      .nav-link:focus,
      .form-control:focus,
      .dropdown-item:focus {
        outline: 2px solid var(--primary-color);
        outline-offset: 2px;
      }

      /* Enhanced Navbar Container */
      .navbar .container {
        max-width: 1200px;
      }

      /* Ensure navbar items stay on same line */
      @media (min-width: 992px) {
        .navbar-nav {
          flex-direction: row;
          align-items: center;
        }

        .navbar-nav .nav-item {
          margin: 0 0.1rem;
        }
      }

      /* Enhanced loading animation */
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      .loading-pulse {
        animation: pulse 2s infinite;
      }

      /* Enhanced glass effect */
      .glass-effect {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      /* Enhanced gradient text effects */
      .text-gradient-primary {
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--primary-light) 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .text-gradient-accent {
        background: linear-gradient(
          135deg,
          var(--accent-color) 0%,
          var(--accent-dark) 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
    </style>

    {% block extra_css %}{% endblock %}
  </head>
  <body>
    <!-- Enhanced Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container">
        <a class="navbar-brand" href="{% url 'hirevision:home' %}">
          <span>HireVision</span>
          <img
            src="{% static 'vision.png' %}"
            alt="HireVision Logo"
            width="32"
            height="32"
            class="d-inline-block align-text-top"
          />
        </a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'hirevision:home' %}">
                <i class="fas fa-home"></i>
                <span>Home</span>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="{% url 'hirevision:resume_analyzer' %}"
                data-requires-auth="true"
              >
                <i class="fas fa-search"></i>
                <span>Analyzer</span>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="{% url 'hirevision:learning_path_analyzer' %}"
                data-requires-auth="true"
              >
                <i class="fas fa-road"></i>
                <span>Learning</span>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="{% url 'hirevision:resume_builder' %}"
                data-requires-auth="true"
              >
                <i class="fas fa-file-alt"></i>
                <span>Resume Builder</span>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="{% url 'hirevision:threads_list' %}"
                data-requires-auth="true"
              >
                <i class="fas fa-comments"></i>
                <span>Discussions</span>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="{% url 'hirevision:messages_list' %}"
                data-requires-auth="true"
              >
                <i class="fas fa-envelope"></i>
                <span>Inbox</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'hirevision:sample_resume' %}">
                <i class="fas fa-eye"></i>
                <span>Sample</span>
              </a>
            </li>
          </ul>

          <!-- Authentication Links -->
          <ul class="navbar-nav">
            {% if user.is_authenticated %}
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="fas fa-user-circle"></i>
                <span>{{ user.first_name|default:user.username }}</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end">
                <li>
                  <a
                    class="dropdown-item"
                    href="{% url 'hirevision:profile' %}"
                  >
                    <i class="fas fa-user"></i>
                    <span>Profile</span>
                  </a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" href="{% url 'hirevision:logout' %}">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Sign Out</span>
                  </a>
                </li>
              </ul>
            </li>
            {% else %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'hirevision:login' %}">
                <i class="fas fa-sign-in-alt"></i>
                <span>Sign In</span>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link btn btn-outline-light btn-sm ms-2"
                href="{% url 'hirevision:signup' %}"
              >
                <i class="fas fa-user-plus"></i>
                <span>Sign Up</span>
              </a>
            </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main style="margin-top: 85px; min-height: calc(100vh - 200px)">
      <!-- Page Content -->
      {% block content %}{% endblock %}
    </main>

    <!-- Enhanced Toast Messages Container -->
    <div
      class="toast-container position-fixed top-0 end-0 p-3"
      style="z-index: 1055; margin-top: 90px"
    >
      {% if messages %} {% for message in messages %}
      <div
        class="toast show fade-in-up"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        data-bs-autohide="false"
      >
        <div class="toast-header alert-{{ message.tags }} border-0">
          {% if message.tags == 'success' %}
          <i class="fas fa-check-circle me-2"></i>
          {% elif message.tags == 'error' or message.tags == 'danger' %}
          <i class="fas fa-exclamation-triangle me-2"></i>
          {% elif message.tags == 'warning' %}
          <i class="fas fa-exclamation-circle me-2"></i>
          {% else %}
          <i class="fas fa-info-circle me-2"></i>
          {% endif %}
          <strong class="me-auto">Notification</strong>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
        <div class="toast-body">{{ message }}</div>
      </div>
      {% endfor %} {% endif %}
    </div>

    <!-- Enhanced Footer -->
    <footer class="py-4 mt-5">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-md-6">
            <p class="mb-0 fw-500">
              &copy; 2025 HireVision. Your AI-Powered Career Success Platform.
            </p>
          </div>
          <div class="col-md-6 text-md-end">
            <div
              class="d-flex justify-content-md-end justify-content-center gap-3 mt-3 mt-md-0"
            ></div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Enhanced Authentication Required Modal -->
    <div
      class="modal fade"
      id="authRequiredModal"
      tabindex="-1"
      aria-labelledby="authRequiredModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-gradient-primary text-white border-0">
            <h5 class="modal-title fw-700" id="authRequiredModalLabel">
              <i class="fas fa-shield-alt me-2"></i>Authentication Required
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body text-center">
            <div class="mb-4">
              <div class="mb-4">
                <i
                  class="fas fa-user-lock fa-4x text-gradient-primary mb-3"
                ></i>
              </div>
              <h4 class="fw-700 mb-3 text-gradient-primary">
                Sign In Required
              </h4>
              <p class="text-muted mb-4 fw-500">
                You need to be signed in to access this premium feature. Join
                thousands of professionals who are advancing their careers with
                HireVision.
              </p>
            </div>
            <div class="d-grid gap-3">
              <a
                href="{% url 'hirevision:login' %}"
                class="btn btn-primary btn-lg"
              >
                <i class="fas fa-sign-in-alt me-2"></i>Sign In to Continue
              </a>
              <a
                href="{% url 'hirevision:signup' %}"
                class="btn btn-outline-primary"
              >
                <i class="fas fa-user-plus me-2"></i>Create Free Account
              </a>
            </div>
            <p class="text-muted mt-3 small">
              <i class="fas fa-shield-check me-1"></i>
              Secure & Professional Platform
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div
      id="loadingOverlay"
      class="d-none position-fixed top-0 start-0 w-100 h-100"
      style="
        background: rgba(30, 41, 59, 0.8);
        backdrop-filter: blur(5px);
        z-index: 9999;
      "
    >
      <div class="d-flex align-items-center justify-content-center h-100">
        <div class="text-center text-white">
          <div
            class="spinner-border mb-3"
            style="width: 3rem; height: 3rem"
            role="status"
          >
            <span class="visually-hidden">Loading...</span>
          </div>
          <h5 class="fw-600">Processing...</h5>
          <p class="text-light">Please wait while we handle your request</p>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      // Enhanced client-side functionality
      document.addEventListener('DOMContentLoaded', function() {
          {% if user.is_authenticated %}
          const isAuthenticated = true;
          {% else %}
          const isAuthenticated = false;
          {% endif %}

          // Enhanced authentication check
          const protectedLinks = document.querySelectorAll('[data-requires-auth="true"]');

          protectedLinks.forEach(link => {
              link.addEventListener('click', function(e) {
                  if (!isAuthenticated) {
                      e.preventDefault();
                      const modal = new bootstrap.Modal(document.getElementById('authRequiredModal'));
                      modal.show();

                      // Add gentle shake animation to modal
                      setTimeout(() => {
                          const modalDialog = document.querySelector('#authRequiredModal .modal-dialog');
                          modalDialog.style.animation = 'shake 0.5s ease-in-out';
                      }, 100);
                  }
              });
          });

          // Enhanced toast management
          const toasts = document.querySelectorAll('.toast');
          toasts.forEach((toast, index) => {
              // Stagger toast appearance
              setTimeout(() => {
                  const bsToast = new bootstrap.Toast(toast, {
                      autohide: true,
                      delay: 6000
                  });
                  bsToast.show();
              }, index * 200);
          });

          // Enhanced smooth scrolling
          document.querySelectorAll('a[href^="#"]').forEach(anchor => {
              anchor.addEventListener('click', function (e) {
                  e.preventDefault();
                  const target = document.querySelector(this.getAttribute('href'));
                  if (target) {
                      const headerOffset = 100;
                      const elementPosition = target.getBoundingClientRect().top;
                      const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                      window.scrollTo({
                          top: offsetPosition,
                          behavior: 'smooth'
                      });
                  }
              });
          });

          // Enhanced form handling with loading states
          const forms = document.querySelectorAll('form');
          forms.forEach(form => {
              form.addEventListener('submit', function(e) {
                  const submitBtn = form.querySelector('button[type="submit"], input[type="submit"]');
                  if (submitBtn && !submitBtn.disabled) {
                      // Show loading state
                      submitBtn.disabled = true;
                      submitBtn.classList.add('loading');

                      const originalContent = submitBtn.innerHTML;
                      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing...';

                      // Show loading overlay for longer operations
                      setTimeout(() => {
                          const overlay = document.getElementById('loadingOverlay');
                          if (overlay) {
                              overlay.classList.remove('d-none');
                          }
                      }, 1000);

                      // Reset if form submission fails (fallback)
                      setTimeout(() => {
                          submitBtn.disabled = false;
                          submitBtn.classList.remove('loading');
                          submitBtn.innerHTML = originalContent;
                          const overlay = document.getElementById('loadingOverlay');
                          if (overlay) {
                              overlay.classList.add('d-none');
                          }
                      }, 30000);
                  }
              });
          });

          // Enhanced image preview functionality
          const imageInputs = document.querySelectorAll('input[type="file"][accept*="image"]');
          imageInputs.forEach(input => {
              input.addEventListener('change', function() {
                  const file = this.files[0];
                  if (file) {
                      // Validate file size (max 10MB)
                      if (file.size > 10 * 1024 * 1024) {
                          showToast('File too large', 'Please select an image smaller than 10MB', 'warning');
                          this.value = '';
                          return;
                      }

                      // Validate file type
                      if (!file.type.startsWith('image/')) {
                          showToast('Invalid file type', 'Please select a valid image file', 'danger');
                          this.value = '';
                          return;
                      }

                      const reader = new FileReader();
                      reader.onload = function(e) {
                          let preview = input.parentNode.querySelector('.image-preview');
                          if (!preview) {
                              preview = document.createElement('div');
                              preview.className = 'image-preview mt-3 p-3 text-center';
                              input.parentNode.appendChild(preview);
                          }

                          preview.innerHTML = `
                              <div class="position-relative d-inline-block">
                                  <img src="${e.target.result}" class="img-fluid rounded shadow-sm" style="max-height: 200px; max-width: 100%;" alt="Preview">
                                  <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0 m-2 rounded-circle" onclick="removePreview(this)" style="width: 30px; height: 30px; padding: 0;">
                                      <i class="fas fa-times"></i>
                                  </button>
                              </div>
                              <small class="text-muted d-block mt-2 fw-500">
                                  <i class="fas fa-image me-1"></i>${file.name}
                                  <span class="text-success">
                                      <i class="fas fa-check ms-2"></i>Ready to upload
                                  </span>
                              </small>
                          `;

                          // Add fade-in animation
                          preview.style.opacity = '0';
                          preview.style.transform = 'translateY(20px)';
                          setTimeout(() => {
                              preview.style.transition = 'all 0.3s ease';
                              preview.style.opacity = '1';
                              preview.style.transform = 'translateY(0)';
                          }, 50);
                      };
                      reader.readAsDataURL(file);
                  }
              });
          });

          // Enhanced navbar scroll behavior
          let lastScrollTop = 0;
          const navbar = document.querySelector('.navbar');

          window.addEventListener('scroll', function() {
              const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

              if (scrollTop > lastScrollTop && scrollTop > 100) {
                  // Scrolling down
                  navbar.style.transform = 'translateY(-100%)';
              } else {
                  // Scrolling up
                  navbar.style.transform = 'translateY(0)';
              }

              // Add background opacity based on scroll
              const opacity = Math.min(scrollTop / 100, 1);
              navbar.style.background = `rgba(30, 41, 59, ${0.95 + (opacity * 0.05)})`;

              lastScrollTop = scrollTop;
          });

          // Enhanced active link highlighting
          const currentPath = window.location.pathname;
          const navLinks = document.querySelectorAll('.nav-link');

          navLinks.forEach(link => {
              if (link.getAttribute('href') === currentPath) {
                  link.classList.add('active');
              }
          });

          // Enhanced keyboard navigation
          document.addEventListener('keydown', function(e) {
              // ESC key closes modals
              if (e.key === 'Escape') {
                  const openModals = document.querySelectorAll('.modal.show');
                  openModals.forEach(modal => {
                      const bsModal = bootstrap.Modal.getInstance(modal);
                      if (bsModal) bsModal.hide();
                  });
              }

              // Ctrl/Cmd + K for quick search (if implemented)
              if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                  e.preventDefault();
                  const searchInput = document.querySelector('input[type="search"]');
                  if (searchInput) {
                      searchInput.focus();
                  }
              }
          });

          // Enhanced form validation feedback
          const forms = document.querySelectorAll('form');
          forms.forEach(form => {
              const inputs = form.querySelectorAll('.form-control');

              inputs.forEach(input => {
                  input.addEventListener('blur', function() {
                      validateField(this);
                  });

                  input.addEventListener('input', function() {
                      if (this.classList.contains('is-invalid')) {
                          validateField(this);
                      }
                  });
              });
          });

          // Add fade-in animation to main content
          const mainContent = document.querySelector('main');
          if (mainContent) {
              mainContent.classList.add('fade-in-up');
          }

          // Enhanced tooltip initialization
          const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
          tooltipTriggerList.map(function (tooltipTriggerEl) {
              return new bootstrap.Tooltip(tooltipTriggerEl, {
                  animation: true,
                  delay: { show: 500, hide: 100 }
              });
          });

          // Performance optimization: Lazy load images
          const images = document.querySelectorAll('img[data-src]');
          const imageObserver = new IntersectionObserver((entries, observer) => {
              entries.forEach(entry => {
                  if (entry.isIntersecting) {
                      const img = entry.target;
                      img.src = img.dataset.src;
                      img.classList.remove('lazy');
                      observer.unobserve(img);
                  }
              });
          });

          images.forEach(img => imageObserver.observe(img));
      });

      // Helper Functions
      function removePreview(button) {
          const preview = button.closest('.image-preview');
          const input = preview.previousElementSibling;

          // Clear the file input
          if (input && input.type === 'file') {
              input.value = '';
          }

          // Remove preview with animation
          preview.style.transition = 'all 0.3s ease';
          preview.style.opacity = '0';
          preview.style.transform = 'translateY(-20px)';

          setTimeout(() => {
              preview.remove();
          }, 300);
      }

      function showToast(title, message, type = 'info') {
          const toastContainer = document.querySelector('.toast-container');
          const toastId = 'toast-' + Date.now();

          const iconMap = {
              success: 'fa-check-circle',
              danger: 'fa-exclamation-triangle',
              warning: 'fa-exclamation-circle',
              info: 'fa-info-circle'
          };

          const toastHTML = `
              <div id="${toastId}" class="toast fade-in-up" role="alert" aria-live="assertive" aria-atomic="true">
                  <div class="toast-header alert-${type} border-0">
                      <i class="fas ${iconMap[type] || iconMap.info} me-2"></i>
                      <strong class="me-auto">${title}</strong>
                      <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                  </div>
                  <div class="toast-body">
                      ${message}
                  </div>
              </div>
          `;

          toastContainer.insertAdjacentHTML('beforeend', toastHTML);

          const newToast = document.getElementById(toastId);
          const bsToast = new bootstrap.Toast(newToast, {
              autohide: true,
              delay: 5000
          });

          bsToast.show();

          // Remove toast element after it's hidden
          newToast.addEventListener('hidden.bs.toast', function() {
              this.remove();
          });
      }

      function validateField(field) {
          const value = field.value.trim();
          const type = field.type;
          const required = field.hasAttribute('required');

          // Remove existing validation classes
          field.classList.remove('is-valid', 'is-invalid');

          // Check if required field is empty
          if (required && !value) {
              field.classList.add('is-invalid');
              return false;
          }

          // Email validation
          if (type === 'email' && value) {
              const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
              if (!emailRegex.test(value)) {
                  field.classList.add('is-invalid');
                  return false;
              }
          }

          // Password validation (minimum 8 characters)
          if (type === 'password' && value) {
              if (value.length < 8) {
                  field.classList.add('is-invalid');
                  return false;
              }
          }

          // If we get here, field is valid
          if (value) {
              field.classList.add('is-valid');
          }

          return true;
      }

      function showLoadingOverlay() {
          const overlay = document.getElementById('loadingOverlay');
          if (overlay) {
              overlay.classList.remove('d-none');
          }
      }

      function hideLoadingOverlay() {
          const overlay = document.getElementById('loadingOverlay');
          if (overlay) {
              overlay.classList.add('d-none');
          }
      }

      // Enhanced keyboard shortcuts
      document.addEventListener('keydown', function(e) {
          // Alt + H for Home
          if (e.altKey && e.key === 'h') {
              e.preventDefault();
              window.location.href = "{% url 'hirevision:home' %}";
          }

          // Alt + R for Resume Analyzer
          if (e.altKey && e.key === 'r' && isAuthenticated) {
              e.preventDefault();
              window.location.href = "{% url 'hirevision:resume_analyzer' %}";
          }

          // Alt + L for Learning Path
          if (e.altKey && e.key === 'l' && isAuthenticated) {
              e.preventDefault();
              window.location.href = "{% url 'hirevision:learning_path_analyzer' %}";
          }
      });

      // CSS animations for shake effect
      const style = document.createElement('style');
      style.textContent = `
          @keyframes shake {
              0%, 100% { transform: translateX(0); }
              25% { transform: translateX(-5px); }
              75% { transform: translateX(5px); }
          }

          .hover-accent {
              transition: all 0.3s ease;
          }

          .hover-accent:hover {
              color: var(--accent-color) !important;
              transform: translateY(-2px);
          }

          .fw-500 { font-weight: 500; }
          .fw-600 { font-weight: 600; }
          .fw-700 { font-weight: 700; }
      `;
      document.head.appendChild(style);
    </script>

    {% block extra_js %}{% endblock %}
  </body>
</html>
